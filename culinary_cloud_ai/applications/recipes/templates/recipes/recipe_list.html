{% extends "base.html" %}
{% load static %}

{% block content %}

<div class="search-sort-container">

  <form class="search-bar" method="GET" action="/recipes/">
    <input type="text" name="q" value="{{ request.GET.q }}" placeholder="Search...">
    <button type="submit">Search</button>
  </form>

  <form class="sort-form" method="GET" action="/recipes/">
    <input type="hidden" name="q" value="{{ request.GET.q }}">
    <select name="sort">
      <option value="" disabled {% if not request.GET.sort %}selected{% endif %}>Sort by</option>
      <option value="-created_at" {% if request.GET.sort == "-created_at" %}selected{% endif %}>Newest</option>
      <option value="created_at" {% if request.GET.sort == "created_at" %}selected{% endif %}>Oldest</option>
      <option value="-likes_count" {% if request.GET.sort == "-likes_count" %}selected{% endif %}>Most Liked</option>
      <option value="-annotated_comments_count" {% if request.GET.sort == "-annotated_comments_count" %}selected{% endif %}>Most Commented</option>
    </select>
    <button type="submit">Apply</button>
  </form>

</div>




  <div class="recipe-grid">
    {% for recipe in recipes %}
      {# include the card for each recipe #}
      {% include "recipes/recipe_container.html" %}
    {% empty %}
      <p style="margin:1.5rem;">No recipes yet — why not generate one?</p>
    {% endfor %}
  </div>

  {% if is_paginated %}
    <nav class="pagination">
      {% if page_obj.has_previous %}
        <a href="?page={{ page_obj.previous_page_number }}">← Prev</a>
      {% endif %}
      <span>Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}</span>
      {% if page_obj.has_next %}
        <a href="?page={{ page_obj.next_page_number }}">Next →</a>
      {% endif %}
    </nav>
  {% endif %}
{% endblock %}
